<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pricing Test - Carbonify</title>
    <link rel="stylesheet" href="shared-styles.css">
</head>
<body>
    <div class="main-container">
        <div class="header">
            <div class="carbonify-logo">carbonify</div>
            <h1 class="header-title">Pricing Test</h1>
            <p class="header-subtitle">Test der Preisfunktionen und des neuen Designs</p>
        </div>

        <div class="toggle-section">
            <div class="toggle-group">
                <div class="toggle-label">Fahrzeugklasse</div>
                <div class="toggle-options">
                    <div class="toggle-option active" data-vehicle="M1">PKW (M1)</div>
                    <div class="toggle-option" data-vehicle="N1">Nutzfahrzeug (N1)</div>
                    <div class="toggle-option" data-vehicle="M3">Busse (M3)</div>
                </div>
            </div>

            <div class="toggle-group">
                <div class="toggle-label">Jahr</div>
                <div class="year-selector">
                    <div class="year-chip selected" data-year="2025">Nur 2025</div>
                    <div class="year-chip" data-year="both">2025 & 2026</div>
                    <div class="year-chip" data-year="2026">Nur 2026</div>
                </div>
            </div>

            <div class="toggle-group">
                <div class="toggle-label">Plan</div>
                <div class="priority-toggle">
                    <div class="priority-option active" data-plan="express">Express</div>
                    <div class="priority-option" data-plan="klassik">Klassik</div>
                </div>
            </div>
        </div>

        <div class="plan-content">
            <div class="total-sum-display glare-hover">
                <div class="total-sum-amount" id="priceDisplay">€0</div>
                <div class="total-sum-period" id="periodDisplay">Wähle deine Optionen</div>
                <div class="total-sum-bonus" id="bonusDisplay">+ 30€ Verivox-Bonus</div>
            </div>

            <div class="features-section">
                <h3 class="features-title">Features</h3>
                <ul class="feature-list" id="featureList">
                    <li class="feature-item">
                        <div class="feature-icon">
                            <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <span>Wähle deine Optionen aus</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="cta-section">
            <button class="cta-button" id="ctaButton">
                <span>Jetzt beantragen</span>
            </button>
        </div>
    </div>

    <script src="sample-data.js"></script>
    <script src="shared-utils.js"></script>
    <script>
        // Initialize the test page
        document.addEventListener('DOMContentLoaded', function() {
            let currentVehicle = 'M1';
            let currentYear = '2025';
            let currentPlan = 'express';

            // Setup toggle options
            setupToggleOptions('.toggle-option[data-vehicle]', function(button) {
                currentVehicle = button.dataset.vehicle;
                updateDisplay();
            });

            setupToggleOptions('.priority-option', function(button) {
                currentPlan = button.dataset.plan;
                updateDisplay();
            });

            // Setup year selector
            document.querySelectorAll('.year-chip').forEach(chip => {
                chip.addEventListener('click', function() {
                    document.querySelectorAll('.year-chip').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    currentYear = this.dataset.year;
                    updateDisplay();
                });
            });

            // Setup hover effects and animations
            setupHoverEffects();
            setupScrollAnimations();
            setupFocusManagement();

            function updateDisplay() {
                let price, periodText, features;
                
                if (currentYear === 'both') {
                    price = window.CARBONIFY_SAMPLE_DATA.getTotalSum(currentPlan, currentVehicle);
                    periodText = 'Gesamtsumme 2025 & 2026';
                } else {
                    price = window.CARBONIFY_SAMPLE_DATA.getPrice(currentPlan, currentYear, currentVehicle);
                    periodText = currentYear === '2025' ? 'für 2025' : 'für 2026';
                }

                // Update price with animation
                const priceElement = document.getElementById('priceDisplay');
                animatePriceUpdate(priceElement, `€${price}`, priceElement.textContent);

                // Update period
                const periodElement = document.getElementById('periodDisplay');
                periodElement.textContent = periodText;

                // Update features
                const planData = window.CARBONIFY_SAMPLE_DATA.plans[currentPlan];
                if (planData) {
                    updateFeatures(document.getElementById('featureList'), planData.features);
                }

                // Update CTA button
                updateCTAText('ctaButton', `${planData ? planData.name : currentPlan} jetzt beantragen`);

                // Show success message
                showSuccess(`Preis aktualisiert: €${price}`, document.querySelector('.plan-content'));
            }

            // Initial display
            updateDisplay();

            // Test error handling
            setTimeout(() => {
                showError('Dies ist eine Test-Fehlermeldung', document.querySelector('.plan-content'));
            }, 3000);

            // Test loading state
            document.getElementById('ctaButton').addEventListener('click', function() {
                showLoadingState(document.querySelector('.plan-content'));
                setTimeout(() => {
                    hideLoadingState(document.querySelector('.plan-content'));
                    showSuccess('Test erfolgreich abgeschlossen!', document.querySelector('.plan-content'));
                }, 2000);
            });
        });
    </script>
</body>
</html>
